Date,Service,@level,Message
"2025-07-27T17:56:58.817Z","ai-ops-analytics","INFO","Completed the save of Elephant flow insight object"
"2025-07-27T17:56:58.815Z","ai-ops-analytics","INFO","responseEntity: <200 OK OK,{""uid"":""e8d9a78f-55ec-418d-aec0-65db06211f19"",""severity"":""WARNING"",""category"":""TRAFFIC_CAPACITY"",""impactedResources"":[{""uid"":""e6a7745f-efed-42aa-b353-0c546d53a5ca"",""name"":""dummy_device_25"",""type"":""FTD""}],""title"":""High Traffic Caused by Elephant Flow"",""summary"":""AIOps has detected high traffic on the firewall caused by 1 flow, potentially leading to performance duress in Snort cores."",""createdTime"":""2025-07-27T17:56:54.684+00:00"",""updatedTime"":""2025-07-27T17:56:54.684+00:00"",""data"":{""@type"":""ElephantFlowInsightData"",""flows"":[{""sourceIp"":""10.10.0.98"",""destinationIp"":""20.20.1.98"",""sourcePort"":43000,""destinationPort"":99,""protocol"":6,""stats"":{""cpuUsage"":[{""timestamp"":1753638534,""value"":77.65342830602246},{""timestamp"":1753638594,""value"":87.3639000251764},{""timestamp"":1753638654,""value"":98.80377946805862},{""timestamp"":1753638714,""value"":111.26318816010567},{""timestamp"":1753638774,""value"":109.22602853826831},{""timestamp"":1753638834,""value"":108.2074771637686},{""timestamp"":1753638894,""value"":110.839015414307},{""timestamp"":1753638954,""value"":110.839015414307},{""timestamp"":1753639014,""value"":110.839015414307}],""throughput"":[]},""application"":{""id"":0,""name"":null,""description"":null,""riskIndex"":0}}]},""analysis"":{""detail"":""AIOps has identified '1' high-loss network flow that are significantly impacting Snort core performance.These flows, including a small number of elephant flows consuming a disproportionate amount of bandwidth, are causing high CPU utilization, packet drops, and reduced network speeds."",""probableCauses"":[{""title"":"""",""detail"":""The observed performance issues, including high CPU utilization, packet loss, and overall network slowdown, are likely caused by connections transferring large amounts of data."",""confidence"":""MEDIUM""}],""remediation"":[{""title"":"""",""markdownText"":""Large data transfers can strain your network. To address them effectively, consider these options:## Trusted Applications:If the flow is legitimate and from a trusted source, bypassing security inspection can improve performance. However, ensure proper access controls are in place to prevent misuse.## Risky Applications:If the flow is suspicious or non-critical, throttling can limit its impact on overall network performance. Be mindful not to disrupt essential operations.## Legitimate but Demanding Applications:If the flow is crucial and inspection is mandatory, implementing FTD clustering will effectively handle high throughput. Also consider upgrading your security infrastructure to handle the required throughput without performance bottlenecks.Remember, the optimal approach depends on the specific situation. Carefully evaluate the flow's source, purpose, and risk profile before implementing any solution.""}]},""type"":""ELEPHANT_FLOW"",""state"":""ACTIVE""},[Content-Type:""application/json"", Transfer-Encoding:""chunked"", Connection:""keep-alive"", Date:""Sun, 27 Jul 2025 17:56:58 GMT"", Expires:""0"", X-Frame-Options:""DENY"", Vary:""Origin"", ""Access-Control-Request-Method"", ""Access-Control-Request-Headers"", ""Origin"", Transaction-Id:""812b4423-3369-431c-a658-1c4b94e0c5c2"", X-Content-Type-Options:""nosniff"", X-XSS-Protection:""0"", Cache-Control:""no-cache, no-store, max-age=0, must-revalidate"", Pragma:""no-cache"", X-Cache:""Miss from cloudfront"", Via:""1.1 eb7d416369db7f3961117199ddc9e342.cloudfront.net (CloudFront)"", X-Amz-Cf-Pop:""HIO50-C2"", Alt-Svc:""h3="":443""; ma=86400"", X-Amz-Cf-Id:""BeQVGXABttNYcfobuFc5-lRBK8vlNQVgtZD2bh1iXG6j1O3H9JhbCQ==""]>"
"2025-07-27T17:56:58.721Z","ai-ops-insights","DEBUG","InsightModelController::Save insight"
"2025-07-27T17:56:58.689Z","ai-ops-analytics","DEBUG","AiopsInsightApiClient::Save insight model"
"2025-07-27T17:56:58.688Z","ai-ops-analytics","INFO","Creating new insight model"
"2025-07-27T17:56:58.670Z","ai-ops-insights","DEBUG","http://platform.staging.cdo.cisco.com/v1/insights called with query param (insightType:ELEPHANT_FLOW AND impactedResources.uid:e6a7745f-efed-42aa-b353-0c546d53a5ca AND insightState:ACTIVE)"
"2025-07-27T17:56:58.669Z","ai-ops-insights","DEBUG","InsightModelController::Get Insights"
"2025-07-27T17:56:58.643Z","ai-ops-analytics","DEBUG","AiopsInsightApiClient::Get Insights with filter (insightType:ELEPHANT_FLOW AND impactedResources.uid:e6a7745f-efed-42aa-b353-0c546d53a5ca AND insightState:ACTIVE)"
"2025-07-27T17:56:58.643Z","ai-ops-analytics","INFO","Saving Elephant flow insight object"
"2025-07-27T17:56:58.487Z","ai-ops-analytics","INFO","Executing Create or Update AIOPS Alert for Elephant Flow"
"2025-07-27T17:56:57.860Z","ai-ops-analytics","INFO","Completed Elephant Flow Process Application Data"
"2025-07-27T17:56:57.822Z","vdb-applications","INFO","2025-07-27T17:56:57.822Z	d00bb693-65c4-4564-95fb-5ad930409a43	INFO	[dd.trace_id=2026954627432687273 dd.span_id=7320157146628859772] The latest vdb version from db is : vdb_411"
"2025-07-27T17:56:55.994Z","ai-ops-analytics","INFO","ElephantFlow Count : 1"
"2025-07-27T17:56:55.902Z","ai-ops-analytics","DEBUG","AiopsDataQueryApiClient::executeRangeQuery : Query= {rate(efd_total_bytes{uuid=""c59d1eba-3169-11f0-bd43-f2c0a0fdf6a8"",}[3m])}&start=1753638414&end=1753639014&step=1m"
"2025-07-27T17:56:55.769Z","ai-ops-analytics","DEBUG","AiopsDataQueryApiClient::executeRangeQuery : Query= {efd_cpu_usage{uuid=""c59d1eba-3169-11f0-bd43-f2c0a0fdf6a8"",}}&start=1753638414&end=1753639014&step=1m"
"2025-07-27T17:56:55.752Z","ai-ops-insights","DEBUG","http://platform.staging.cdo.cisco.com/v1/insights called with query param (insightType:ELEPHANT_FLOW AND impactedResources.uid:e6a7745f-efed-42aa-b353-0c546d53a5ca AND insightState:ACTIVE)"
"2025-07-27T17:56:55.751Z","ai-ops-insights","DEBUG","InsightModelController::Get Insights"
"2025-07-27T17:56:55.714Z","ai-ops-analytics","DEBUG","AiopsInsightApiClient::Get Insights with filter (insightType:ELEPHANT_FLOW AND impactedResources.uid:e6a7745f-efed-42aa-b353-0c546d53a5ca AND insightState:ACTIVE)"
"2025-07-27T17:56:55.613Z","ai-ops-analytics","INFO","Executing Alert Trigger - Elephant Flow Process Application Data"
"2025-07-27T17:56:55.414Z","ai-ops-analytics","INFO","Processing Alert Trigger. Module Name: ELEPHANT_FLOW Alert Type: FIRING Device Id: c59d1eba-3169-11f0-bd43-f2c0a0fdf6a8"
"2025-07-27T17:56:55.411Z","ai-ops-analytics","INFO","Executing Alert Trigger Prepare Action"
"2025-07-27T17:56:55.222Z","ai-ops-orchestrator","DEBUG","Finished plugin execution : PluginConfig(plugin=WEBHOOK, config={moduleName=ELEPHANT_FLOW, destination=ai-ops-analytics})"
"2025-07-27T17:56:55.222Z","ai-ops-orchestrator","INFO","Alert trigger posted to ai-ops-analytics"
"2025-07-27T17:56:55.222Z","ai-ops-orchestrator","INFO","Alert trigger of type ELEPHANT_FLOW for device c59d1eba-3169-11f0-bd43-f2c0a0fdf6a8 posted to AIOPS Analytics"
"2025-07-27T17:56:55.222Z","ai-ops-orchestrator","INFO","responseEntity: <200 OK OK,{""tags"":{},""tagKeys"":[],""tagValues"":[],""uid"":""8af20428-4797-4085-9ed5-597b650b00f2"",""name"":"""",""namespace"":""aiops"",""type"":""alert-trigger"",""version"":1,""createdDate"":1753639014862,""lastUpdatedDate"":1753639015133,""actionContext"":null,""stateMachineContext"":null,""stateDate"":null,""status"":""IDLE"",""stateMachineDetails"":null,""scheduledStateMachineEnabledMap"":{},""pendingStatesQueue"":[],""createdTenantUid"":null,""moduleName"":""ELEPHANT_FLOW"",""deviceId"":""c59d1eba-3169-11f0-bd43-f2c0a0fdf6a8"",""alertType"":""FIRING"",""state"":null,""triggerState"":null,""queueTriggerState"":null,""alertDate"":1753639014684},[Content-Type:""application/json"", Transfer-Encoding:""chunked"", Connection:""keep-alive"", Date:""Sun, 27 Jul 2025 17:56:55 GMT"", Expires:""0"", X-Frame-Options:""DENY"", Vary:""Origin"", ""Access-Control-Request-Method"", ""Access-Control-Request-Headers"", ""Origin"", Transaction-Id:""3fac504d-d575-470c-aba4-39b7dc76f2a5"", X-Content-Type-Options:""nosniff"", X-XSS-Protection:""0"", Cache-Control:""no-cache, no-store, max-age=0, must-revalidate"", Pragma:""no-cache"", X-Cache:""Miss from cloudfront"", Via:""1.1 d4269b452831f0e203a89d437c84974c.cloudfront.net (CloudFront)"", X-Amz-Cf-Pop:""HIO50-C2"", Alt-Svc:""h3="":443""; ma=86400"", X-Amz-Cf-Id:""iN1FpruKbGl9jE26s3m_kuFUEdLOXrBAqjUTTSC9jotx8_lhqfKizg==""]>"
"2025-07-27T17:56:54.801Z","ai-ops-orchestrator","DEBUG","Starting plugin execution : PluginConfig(plugin=WEBHOOK, config={moduleName=ELEPHANT_FLOW, destination=ai-ops-analytics})"
"2025-07-27T17:56:54.801Z","ai-ops-orchestrator","DEBUG","Finished plugin execution : PluginConfig(plugin=FTD_MINIMUM_VERSION, config={min-version=7.6, moduleName=ELEPHANT_FLOW, destination=ai-ops-analytics})"
"2025-07-27T17:56:54.801Z","ai-ops-orchestrator","DEBUG","Starting plugin execution : PluginConfig(plugin=FTD_MINIMUM_VERSION, config={min-version=7.6, moduleName=ELEPHANT_FLOW, destination=ai-ops-analytics})"
"2025-07-27T17:56:54.799Z","ai-ops-orchestrator","DEBUG","Processing a FIRING alert : PrometheusAlert(status=firing, labels={alertname=ElephantFlowDuressDetected, severity=critical, tenant_uuid=af5f6035-7538-4709-b073-7b5f4b69543c, uuid=c59d1eba-3169-11f0-bd43-f2c0a0fdf6a8}, annotations={summary=Snort busy detected with elephant flow by device, timestamp=2025-07-27 17:56:54.684 +0000 UTC}, startsAt=2025-07-27T17:56:54.685Z, endsAt=0001-01-01T00:00:00Z, generatorURL=https://stagingaiopscisco.grafana.net/explore?left=%7B%22datasource%22%3A%22grafanacloud-prom%22%2C%22queries%22%3A%5B%7B%22datasource%22%3A%7B%22type%22%3A%22prometheus%22%2C%22uid%22%3A%22grafanacloud-prom%22%7D%2C%22expr%22%3A%22count+by+%28tenant_uuid%2C+uuid%29+%28efd_cpu_usage%29+%3E+0+and+on+%28tenant_uuid%29+elephant_flow_enabled+%3E+0%22%2C%22refId%22%3A%22A%22%7D%5D%2C%22range%22%3A%7B%22from%22%3A%22now-1h%22%2C%22to%22%3A%22now%22%7D%7D, fingerPrint=null)"
"2025-07-27T17:56:54.798Z","ai-ops-orchestrator","DEBUG","Security context set for tenant"
"2025-07-27T17:56:54.754Z","ai-ops-alert-services","INFO","Alert notification published, AlertName: ElephantFlowDuressDetected, AlertStatus: firing, tenantId: af5f6035-7538-4709-b073-7b5f4b69543c"